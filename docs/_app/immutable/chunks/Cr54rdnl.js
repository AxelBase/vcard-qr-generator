import{g as N}from"./Cpj98o6Y.js";var L={exports:{}},D=L.exports,_;function R(){return _||(_=1,(function(s,g){(function(y,v){s.exports=v()})(typeof self<"u"?self:D,(()=>{return y={20:(n,o,a)=>{var i=a(595);n.exports=function(e,p,l){return(p=i(p))in e?Object.defineProperty(e,p,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[p]=l,e},n.exports.__esModule=!0,n.exports.default=n.exports},110:(n,o,a)=>{var i=a(871).default;n.exports=function(e,p){if(i(e)!="object"||!e)return e;var l=e[Symbol.toPrimitive];if(l!==void 0){var u=l.call(e,p||"default");if(i(u)!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(p==="string"?String:Number)(e)},n.exports.__esModule=!0,n.exports.default=n.exports},136:function(n,o,a){var i,e,p;e=[o,a(704)],(p=typeof(i=function(l,u){var c=a(957);Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0,u=c(u),l.default=u.default})=="function"?i.apply(o,e):i)===void 0||(n.exports=p)},215:function(n,o){var a,i;(i=typeof(a=function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MIME_TYPES=e.Formats=e.DEFAULT_MIME_TYPE=e.DEFAULT_FORMAT=e.DEFAULT_FILENAME=e.DEFAULT_EXTENSION=e.DEFAULT_CONTENT_TYPE=e.DEFAULT_CHARACTER_SET=e.ContentTypes=e.ALLOWED_MULTIPLE_PROPERTIES=void 0;let p=e.ContentTypes=(function(u){return u.VCALENDAR="text/x-vcalendar",u.VCARD="text/x-vcard",u})({}),l=e.Formats=(function(u){return u.VCALENDAR="vcalendar",u.VCARD="vcard",u})({});e.ALLOWED_MULTIPLE_PROPERTIES=["address","email","phoneNumber","social","url"],e.DEFAULT_CHARACTER_SET="utf-8",e.DEFAULT_CONTENT_TYPE=p.VCARD,e.DEFAULT_EXTENSION="vcf",e.DEFAULT_FILENAME="vcard",e.DEFAULT_FORMAT=l.VCARD,e.DEFAULT_MIME_TYPE="JPEG",e.MIME_TYPES=["aces","avci","avcs","avif","bmp","cgm","dicom-rle","emf","example","fits","g3fax","gif","heic","heic-sequence","heif","heif-sequence","hej2k","hsj2","ief","jls","jp2","jpeg","jph","jphc","jpm","jpx","jxr","jxrA","jxrS","jxs","jxsc","jxsi","jxss","ktx","ktx2","naplps","png","prs.btif","prs.pti","pwg-raster","svg+xml","t38","tiff","tiff-fx","vnd.adobe.photoshop","vnd.airzip.accelerator.azv","vnd.cns.inf2","vnd.dece.graphic","vnd.djvu","vnd.dwg","vnd.dxf","vnd.dvb.subtitle","vnd.fastbidsheet","vnd.fpx","vnd.fst","vnd.fujixerox.edmics-mmr","vnd.fujixerox.edmics-rlc","vnd.globalgraphics.pgb","vnd.microsoft.icon","vnd.mix","vnd.ms-modi","vnd.mozilla.apng","vnd.net-fpx","vnd.pco.b16","vnd.radiance","vnd.sealed.png","vnd.sealedmedia.softseal.gif","vnd.sealedmedia.softseal.jpg","vnd.svf","vnd.tencent.tap","vnd.valve.source.texture","vnd.wap.wbmp","vnd.xiff","vnd.zbrush.pcx","wmf","x-emf","x-wmf"]})=="function"?a.apply(o,[o]):a)===void 0||(n.exports=i)},443:function(n,o){var a,i;(i=typeof(a=function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;class p extends Error{constructor(u){super(u),Error.captureStackTrace&&Error.captureStackTrace(this,p),this.name="VCardException"}}e.default=p})=="function"?a.apply(o,[o]):a)===void 0||(n.exports=i)},595:(n,o,a)=>{var i=a(871).default,e=a(110);n.exports=function(p){var l=e(p,"string");return i(l)=="symbol"?l:l+""},n.exports.__esModule=!0,n.exports.default=n.exports},704:function(n,o,a){var i,e,p;e=[o,a(20),a(443),a(979),a(215)],i=function(l,u,c,m,h){var C=a(957);function T(t){if(typeof WeakMap!="function")return null;var r=new WeakMap,d=new WeakMap;return(T=function(f){return f?d:r})(t)}Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0,u=C(u),c=C(c),h=(function(t,r){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var d=T(r);if(d&&d.has(t))return d.get(t);var f={__proto__:null},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in t)if(x!=="default"&&{}.hasOwnProperty.call(t,x)){var P=A?Object.getOwnPropertyDescriptor(t,x):null;P&&(P.get||P.set)?Object.defineProperty(f,x,P):f[x]=t[x]}return f.default=t,d&&d.set(t,f),f})(h),l.default=class{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:h.DEFAULT_FORMAT;(0,u.default)(this,"charset",h.DEFAULT_CHARACTER_SET),(0,u.default)(this,"contentType",h.DEFAULT_CONTENT_TYPE),(0,u.default)(this,"filename",h.DEFAULT_FILENAME),(0,u.default)(this,"fileExtension",h.DEFAULT_EXTENSION),(0,u.default)(this,"properties",[]),(0,u.default)(this,"definedElements",{}),(0,u.default)(this,"multiplePropertiesForElementAllowed",h.ALLOWED_MULTIPLE_PROPERTIES),(0,u.default)(this,"useVCalendar",!1),t===h.Formats.VCALENDAR&&this.setFormat(t)}setFormat(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:h.DEFAULT_FORMAT;t===h.Formats.VCALENDAR?(console.warn("The format 'vcalendar' is deprecated and will be removed in the next major or minor release. Use 'vcard' instead."),this.contentType=h.ContentTypes.VCALENDAR,this.useVCalendar=!0):t===h.Formats.VCARD&&(this.contentType=h.ContentTypes.VCARD,this.useVCalendar=!1)}addAddress(){let t=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"WORK;POSTAL";const r=`${arguments.length>0&&arguments[0]!==void 0?arguments[0]:""};${arguments.length>1&&arguments[1]!==void 0?arguments[1]:""};${arguments.length>2&&arguments[2]!==void 0?arguments[2]:""};${arguments.length>3&&arguments[3]!==void 0?arguments[3]:""};${arguments.length>4&&arguments[4]!==void 0?arguments[4]:""};${arguments.length>5&&arguments[5]!==void 0?arguments[5]:""};${arguments.length>6&&arguments[6]!==void 0?arguments[6]:""}`;return this.setProperty("address",`ADR${t!==""?`;${t}`:""}${this.getCharsetString()}`,r),this}addBirthday(t){return this.setProperty("birthday","BDAY",t),this}addCompany(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return this.setProperty("company",`ORG${this.getCharsetString()}`,t+(r!==""?`;${r}`:"")),this}addEmail(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return this.setProperty("email","EMAIL;INTERNET"+(r!==""?`;${r}`:""),t),this}addJobtitle(t){return this.setProperty("jobtitle",`TITLE${this.getCharsetString()}`,t),this}addRole(t){return this.setProperty("role",`ROLE${this.getCharsetString()}`,t),this}addMediaURL(t,r,d){return this.setProperty(d,`${t};VALUE=uri`,r),this}addMediaContent(t,r,d,f){if(!(0,m.isValidMimeType)(d))throw new c.default(`The MIME Media Type is invalid (${d})`);return this.setProperty(f,`${t};ENCODING=b;TYPE=${d.toUpperCase()}`,r),this}addName(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",A=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"";const x=[f,r,d,t,A].filter((b=>!!b)),P=`${t};${r};${d};${f};${A}`;return this.setProperty("name",`N${this.getCharsetString()}`,P),this.hasProperty("FN")||this.setProperty("fullname",`FN${this.getCharsetString()}`,x.join(" ").trim()),this}addNickname(t){return this.setProperty("nickname","NICKNAME",Array.isArray(t)?t.join(",").trim():t),this}addNote(t){return this.setProperty("note",`NOTE${this.getCharsetString()}`,t),this}addCategories(t){return this.setProperty("categories",`CATEGORIES${this.getCharsetString()}`,t.join(",").trim()),this}addPhoneNumber(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return this.setProperty("phoneNumber","TEL"+(r!==""?`;${r}`:""),`${t}`),this}addLogoURL(t){return this.addMediaURL("LOGO",t,"logo"),this}addLogo(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h.DEFAULT_MIME_TYPE;return this.addMediaContent("LOGO",t,r,"logo"),this}addPhotoURL(t){return this.addMediaURL("PHOTO",t,"photo"),this}addPhoto(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h.DEFAULT_MIME_TYPE;return this.addMediaContent("PHOTO",t,r,"photo"),this}addURL(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return this.setProperty("url","URL"+(r!==""?`;${r}`:""),t),this}addSocial(t,r){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const f=d!==""?`;x-user=${d}`:"",A=r!==""?`;type=${r}`:"";return this.setProperty("social",`X-SOCIALPROFILE${A}${f}`,t),this}addUID(t){return this.setProperty("uid","UID",t),this}buildVCard(){const t=new Date;let r="";return r+=`BEGIN:VCARD\r
`,r+=`VERSION:3.0\r
`,r+=`REV:${t.toISOString()}\r
`,this.getProperties().forEach((d=>{r+=(0,m.fold)(`${d.key}:${(0,m.escape)(d.value)}\r
`)})),r+=`END:VCARD\r
`,r}buildVCalendar(){console.warn("The method 'buildVCalendar' is deprecated and will be removed in the next major or minor release. Use 'buildVCard' instead.");const t=new Date().toISOString().replace(/-/g,"").replace(/:/g,"").substring(0,13),r=`${t}00`,d=`${t}01`,f=(0,m.b64encode)(this.buildVCard()),A=(0,m.chunkSplit)(f,74,`
`).replace(/(.+)/g," $1");return`BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
DTSTART;TZID=Europe/London:${r}
DTEND;TZID=Europe/London:${d}
SUMMARY:Click the attachment to save to your contacts
DTSTAMP:${r}Z
ATTACH;VALUE=BINARY;ENCODING=BASE64;FMTTYPE=text/directory;
 X-APPLE-FILENAME=${this.getFilename()}.${this.getFileExtension()}:
${A}END:VEVENT
END:VCALENDAR
`}toString(){return this.getOutput()}getCharset(){return this.charset}getCharsetString(){let t="";return this.charset===h.DEFAULT_CHARACTER_SET&&(t=`;CHARSET=${this.charset}`),t}getContentType(){return this.contentType}getFilename(){return this.filename}getFileExtension(){return this.fileExtension}getOutput(){return this.useVCalendar?this.buildVCalendar():this.buildVCard()}getProperties(){return this.properties}hasProperty(t){return this.getProperties().some((r=>r.key===t&&r.value!==""))}setCharset(t){this.charset=t}setFilename(t){t&&(this.filename=t)}setProperty(t,r,d){if(!this.multiplePropertiesForElementAllowed.includes(t)&&this.definedElements[t])throw new c.default(`This element already exists (${t})`);this.definedElements[t]=!0,this.properties.push({key:r,value:d})}}},(p=i.apply(o,e))===void 0||(n.exports=p)},871:n=>{function o(a){return n.exports=o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},n.exports.__esModule=!0,n.exports.default=n.exports,o(a)}n.exports=o,n.exports.__esModule=!0,n.exports.default=n.exports},957:n=>{n.exports=function(o){return o&&o.__esModule?o:{default:o}},n.exports.__esModule=!0,n.exports.default=n.exports},979:function(n,o,a){var i,e,p;e=[o,a(215)],i=function(l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.b64encode=function(c){try{return btoa(c)}catch{return Buffer.from(c).toString("base64")}},l.chunkSplit=function(c){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:76;const h=m||76,C=(arguments.length>2&&arguments[2]!==void 0?arguments[2]:`\r
`)||`\r
`;if(m<1)return"";const T=c.match(new RegExp(`.{0,${h}}`,"g"));return T?T.join(C):""},l.escape=function(c){let m=`${c}`.replace(/\r\n/g,"\\n");return m=m.replace(/\n/g,"\\n"),m},l.fold=function(c){return c.length<=75?c:`${(c.match(/.{1,73}/g)||[]).join(`\r
 `).trim()}\r
`},l.isValidMimeType=function(c){return!(!c||!u.MIME_TYPES.includes(c.toLowerCase()))}},(p=i.apply(o,e))===void 0||(n.exports=p)}},v={},(function n(o){var a=v[o];if(a!==void 0)return a.exports;var i=v[o]={exports:{}};return y[o].call(i.exports,i,i.exports,n),i.exports})(136);var y,v}))})(L)),L.exports}var $=R();const M=N($);function E(s){return s?s.toString().trim().replace(/’/g,"'").replace(/‘/g,"'").replace(/“/g,'"').replace(/”/g,'"').normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," "):""}function O(s){return s?(s=E(s).toLowerCase(),s.startsWith("www.")||(s.startsWith("https://")?s=s.replace("https://",""):s.startsWith("http://")&&(s=s.replace("http://","")),s.startsWith("www.")||(s="www."+s)),s):""}function S(s,g,y,v){return[s,g,y,v].filter(n=>n&&n.trim()!=="").join(", ")}function I(s={}){const g=new M,y=E(s.firstName),v=E(s.lastName),n=E(s.organization),o=E(s.title),a=E(s.mobilePhone),i=E(s.workPhone),e=E(s.email),p=E(s.street),l=E(s.city),u=E(s.postalCode),c=E(s.country),m=O(s.website),h=s.photoBase64?s.photoBase64.trim():"";(y||v)&&g.addName(v,y,"","",""),n&&g.addCompany(n),o&&g.addJobtitle(o),a&&g.addPhoneNumber(a,"CELL"),i&&g.addPhoneNumber(i,"WORK;VOICE"),e&&g.addEmail(e),m&&g.addURL(m);const C=S(p,l,u,c);if(C&&g.addAddress("","",C,"","","",""),h){const t=h.replace(/^data:image\/[a-zA-Z]+;base64,/,"");g.addPhoto(t,"JPEG")}let T=g.toString();return T=T.split(`
`).map(t=>t.startsWith("BEGIN:")||t.startsWith("END:")||t.startsWith("VERSION:")||t.startsWith("REV:")?t:t.replace(/^([^:]+):(.*)$/,(r,d,f)=>f.startsWith(" ")?`${d}:${f}`:`${d}: ${f}`)).join(`
`),T}export{I as generateVCard};
